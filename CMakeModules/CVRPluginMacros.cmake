MACRO(ADD_CALVR_LIBRARIES LIB_NAME)
    IF(WIN32)
	    TARGET_LINK_LIBRARIES(${LIB_NAME} ${CALVR_KERNEL_LIBRARY})
		REMOVE_OUTPUT_DIRS(${LIB_NAME})
	ELSE(WIN32)
            IF(APPLE)
                TARGET_LINK_LIBRARIES(${LIB_NAME} ${CALVR_COLLABORATIVE_LIBRARY})
                TARGET_LINK_LIBRARIES(${LIB_NAME} ${CALVR_CONFIG_LIBRARY})
                TARGET_LINK_LIBRARIES(${LIB_NAME} ${CALVR_INPUT_LIBRARY})
                TARGET_LINK_LIBRARIES(${LIB_NAME} ${CALVR_KERNEL_LIBRARY})
                TARGET_LINK_LIBRARIES(${LIB_NAME} ${CALVR_MENU_LIBRARY})
                TARGET_LINK_LIBRARIES(${LIB_NAME} ${CALVR_UTIL_LIBRARY})
            ENDIF(APPLE)
	ENDIF(WIN32)
ENDMACRO(ADD_CALVR_LIBRARIES LIB_NAME)

MACRO(REMOVE_OUTPUT_DIRS LIB)
    IF(MSVC)
        SET_TARGET_PROPERTIES(${LIB} PROPERTIES PREFIX "/")
        FOREACH(CONF ${CMAKE_CONFIGURATION_TYPES})        # For each configuration (Debug, Release, MinSizeRel... and/or anything the user chooses)
            STRING(TOUPPER "${CONF}" CONF)                # Go uppercase (DEBUG, RELEASE...)
            # We use "FILE(TO_CMAKE_PATH", to create nice looking paths
            FILE(TO_CMAKE_PATH "${INSTALL_PREFIX}/bin/calvr-plugins/" TMPVAR)
            SET_TARGET_PROPERTIES(${LIB} PROPERTIES "ARCHIVE_OUTPUT_DIRECTORY_${CONF}" "${TMPVAR}")
            FILE(TO_CMAKE_PATH "${INSTALL_PREFIX}/bin/calvr-plugins/" TMPVAR)
            SET_TARGET_PROPERTIES(${LIB} PROPERTIES "RUNTIME_OUTPUT_DIRECTORY_${CONF}" "${TMPVAR}")
            FILE(TO_CMAKE_PATH "${INSTALL_PREFIX}/lib/calvr-plugins/" TMPVAR)
            SET_TARGET_PROPERTIES(${LIB} PROPERTIES "LIBRARY_OUTPUT_DIRECTORY_${CONF}" "${TMPVAR}")
        ENDFOREACH(CONF ${CMAKE_CONFIGURATION_TYPES})
    ENDIF(MSVC)
ENDMACRO(REMOVE_OUTPUT_DIRS LIB)
